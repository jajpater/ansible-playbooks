;; Guix Home configuration generated by Ansible
;; This is the home environment configuration for {{ ansible_user_id }}

(use-modules (gnu home)
             (gnu packages)
             (gnu services)
             (gnu services shell)
             (gnu services desktop)
             (gnu services guix)
             (gnu services syncthing)
             (gnu packages mail)
             (gnu packages rust-apps)
             (gnu packages version-control)
             (gnu packages emacs))

(operating-system-host-name "{{ ansible_hostname }}")

(simple-service 'some-useful-env-vars
                home-environment-variables-service-type
                '(("EDITOR" . "emacs")
                  ("XDG_CONFIG_HOME" . "$HOME/.config")
                  ("XDG_CACHE_HOME" . "$HOME/.cache")
                  ("XDG_DATA_HOME" . "$HOME/.local/share")))

(home-environment
  ;; Packages to install
  (packages (specifications->packages 
    '({% for package in guix_packages %}
      "{{ package }}"{% if not loop.last %} {% endif %}
      {% endfor %})))
  
  ;; Services to configure
  (services
   (list 
    ;; Shell service with aliases
    (service home-bash-service-type
             (home-bash-configuration
              (aliases '(("grep" . "grep --color=auto")
                         ("ll" . "ls -l")
                         ("la" . "ls -la")
                         ("emacs" . "emacs -nw")))
              (bashrc (list "export PATH=$HOME/.local/bin:$PATH"))
              (bash-profile (list ". ~/.bashrc"))))
    
    ;; XDG configuration files service
    (service home-xdg-configuration-files-service-type
             `(("git/config"
                ,(plain-file "git-config"
                            "[user]
        name = {{ ansible_user_gecos | default(ansible_user_id) }}
        email = {{ ansible_user_id }}@{{ ansible_hostname }}
[init]
        defaultBranch = main"))))
    
    ;; Guix channels configuration
    (extra-special-file ".config/guix/channels.scm"
                       (plain-file "channels.scm"
                                   "(cons* (channel
        (name nonguix)
        (url \"https://gitlab.com/nonguix/nonguix\")
        (branch \"master\")
        (introduction
         (make-channel-introduction
          \"897c1a470da759236cc11798f4e0a5f7d4d59fbc\"
          (openpgp-fingerprint
           \"2A39 3FFF 68F4 EF7A 3D29  12AF 6F51 20A0 22FB B2D5\"))))
      %default-channels)")))))